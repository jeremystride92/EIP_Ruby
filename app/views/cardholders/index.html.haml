%table.table.table-pair-striped
  %thead
    %tr
      %th Cardholders
      %th Issued by
      %th{ colspan: 2 }
        %form#card_level_form.form-search.form-inline{action: venue_cardholders_path, method: :get}
          = select_tag :card_level_id, options_from_collection_for_select(@card_levels, 'id', 'name', @card_level_id), prompt: 'Card Level'
          .input-append
            %input#filter.search-query{ type: :text, name: :filter, value: @filter_string, placeholder: 'Search Last Name' }
            = button_tag class: 'btn' do
              %i.icon-search
      %th= link_to 'Issue Cards', new_venue_cardholder_path, class: 'btn'
  %tbody
    - @cards.each do |card|
      %tr.accordion-header
        %td
          %span.first_name= card.cardholder.first_name
          %span.last_name= card.cardholder.last_name
        %td= card.issuer.name
        %td= card.card_level.name
        %td{ colspan: 2 }
      %tr.accordion-body.hidden
        %td{ colspan: 5 }
          .row-fluid
            .span5
              .card-preview{ class: "theme-#{card.card_level.theme}" }
                .card-name= "#{card.cardholder.first_name} #{card.cardholder.last_name}"
                .card-level= card.card_level.name
                .card-number
                  EIP#
                  = card.cardholder.phone_number
            .actions.span7
              .row-fluid
                = link_to '#', class: 'btn btn-large clearfix span6' do
                  %i.icon-plus.pull-left
                  .pull-left Issue Benefits
                  %i.icon-caret-right.pull-right
              .row-fluid
                = simple_form_for card, url: venue_card_path(card), remote: true do |f|
                  = f.input :card_level_id, collection: @card_levels, label: false, input_html: { class: 'span4' }
                  = f.button :submit, value: 'Change', class: 'span2'

= content_for :javascripts do
  = javascript_include_tag :cardholders
