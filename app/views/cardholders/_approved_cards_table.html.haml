%form#card_level_form.form-search.form-inline.pull-right{action: venue_cardholders_path, method: :get}
  = select_tag :card_level_id, options_from_collection_for_select(@card_levels, 'id', 'name', @card_level_id), prompt: 'Card Level'
  .input-append
    %input#filter.search-query{ type: :text, name: :filter, value: @filter_string, placeholder: 'Search Last Name' }
    = button_tag class: 'btn' do
      %i.icon-search
%table.table.table-pair-striped
  %thead
    %tr
      %th Cardholders
      %th Issued by
      %th{ colspan: 2 }
      %th.btn-toolbar
        .btn-group.pull-right
          %a.btn.dropdown-toggle{ 'data-toggle' => 'dropdown', 'href' => '#' }
            Issue Cards
            %span.caret
          %ul.dropdown-menu
            - @card_levels.each do |card_level|
              %li= link_to card_level.name, new_batch_venue_cardholders_path(card_level_id: card_level.id)
  %tbody
    - @approved_cards.each do |card|
      %tr.accordion-header{ class: "status-#{card.status}" }
        %td.cardholder
          %span.first_name= card.cardholder.first_name
          %span.last_name= card.cardholder.last_name
        %td.card-issuer= card.issuer.name
        %td.card-level-name= card.card_level.name
        %td{ colspan: 2 }
      %tr.accordion-body.hidden
        %td{ colspan: 5 }
          = render partial: 'card_row', locals: { card: card }
