%h1.page-header Benefits
= form_tag do
  = text_field_tag :start_date, @start_date.to_date, type: :date
  to
  = text_field_tag :end_date, @end_date.to_date, type: :date
  = submit_tag 'Filter', class: 'btn btn-large'
%table.table.tbody-striped
  %thead
    %tr
      %th Cardholder
      %th Benefit
      %th Start
      %th End
  - @cards.each do |card|
    %tbody
      %tr
        %th{rowspan: card.benefits.length}
          = card.cardholder.display_name
        - benefit = card.benefits.first
        - if benefit.active_in_range? @start_date, @end_date
          %td= benefit.description
          %td
            - if benefit.start_date
              = l benefit.start_date.in_time_zone(@venue.time_zone), format: :friendly
          %td
            - if benefit.end_date
              = l benefit.end_date.in_time_zone(@venue.time_zone), format: :friendly
      - card.benefits[1..-1].each do |benefit|
        - if benefit.active_in_range? @start_date, @end_date
          %tr
            %td= benefit.description
            %td
              - if benefit.start_date
                = l benefit.start_date.in_time_zone(@venue.time_zone), format: :friendly
            %td
              - if benefit.end_date
                = l benefit.end_date.in_time_zone(@venue.time_zone), format: :friendly
